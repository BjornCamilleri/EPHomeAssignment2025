@model Domain.Models.Poll

@{
    ViewData["Title"] = "Details";
}

<h1>Details</h1>

<div>
    <h4>Poll</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Title)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Title)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Option1Text)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Option1Text)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Option2Text)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Option2Text)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Option3Text)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Option3Text)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.DateCreated)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.DateCreated)</dd>
    </dl>
</div>

<!-- Voting Form -->
<h4>Vote for an Option</h4>
<form asp-action="Vote" method="post">
    <input type="hidden" name="id" value="@Model.Id" />
    <div class="form-check">
        <input class="form-check-input" type="radio" name="option" value="1" id="option1" required>
        <label class="form-check-label" for="option1">@Model.Option1Text</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="option" value="2" id="option2">
        <label class="form-check-label" for="option2">@Model.Option2Text</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="option" value="3" id="option3">
        <label class="form-check-label" for="option3">@Model.Option3Text</label>
    </div>
    <button type="submit" class="btn btn-primary mt-2">Submit Vote</button>
</form>

<div>
    <a asp-action="Index">Back to List</a>
</div>

<!-- Poll Results Chart -->
<h4 class="mt-4">Poll Results</h4>
<canvas id="pollResultsChart"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var ctx = document.getElementById('pollResultsChart').getContext('2d');

        var chartData = {
            labels: [ "@Model.Option1Text", "@Model.Option2Text", "@Model.Option3Text" ],
            datasets: [{
                label: 'Votes',
                data: [ @Model.Option1VotesCount, @Model.Option2VotesCount, @Model.Option3VotesCount ],
                backgroundColor: ['#3498db', '#e74c3c', '#2ecc71'],
                borderColor: ['#2980b9', '#c0392b', '#27ae60'],
                borderWidth: 1
            }]
        };

        new Chart(ctx, {
            type: 'bar',
            data: chartData,
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    });
</script>


